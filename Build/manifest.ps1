# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License.

<#
    .SYNOPSIS
        Provides the list of artifacts (Packages and Assemblies) generated by this repository.
    
    .PARAMETER OutputFormat
        Specifies if the output of this script should be a hashtable with the artifacts
        as strings with the absolute path (AbsolutePath) or FileInfo structures.
#>
param(
    [ValidateSet('FileInfo','AbsolutePath')]
    [string] $OutputFormat = 'FileInfo'
);


& "$PSScriptRoot/set-env.ps1"

$artifacts = @{
    Packages = @(
        "Microsoft.Quantum.Chemistry",
        "Microsoft.Quantum.Chemistry.DataModel",
        "Microsoft.Quantum.Chemistry.Jupyter",
        "Microsoft.Quantum.Chemistry.Runtime",
        "Microsoft.Quantum.Chemistry.Tools",
        "Microsoft.Quantum.MachineLearning",
        "Microsoft.Quantum.Numerics",
        "Microsoft.Quantum.Standard",
        "Microsoft.Quantum.Standard.Visualization"
    ) | ForEach-Object { Join-Path $Env:NUGET_OUTDIR "$_.$Env:NUGET_VERSION.nupkg" };

    Assemblies = @(
        ".\Standard\src\bin\$Env:BUILD_CONFIGURATION\net6.0\Microsoft.Quantum.Standard.dll",
        ".\Visualization\src\bin\$Env:BUILD_CONFIGURATION\net6.0\Microsoft.Quantum.Standard.Visualization.dll",
        ".\Numerics\src\bin\$Env:BUILD_CONFIGURATION\net6.0\Microsoft.Quantum.Numerics.dll",
        ".\MachineLearning\src\bin\$Env:BUILD_CONFIGURATION\net6.0\Microsoft.Quantum.MachineLearning.dll",
        ".\Chemistry\src\DataModel\bin\$Env:BUILD_CONFIGURATION\net6.0\Microsoft.Quantum.Chemistry.DataModel.dll",
        ".\Chemistry\src\Jupyter\bin\$Env:BUILD_CONFIGURATION\net6.0\Microsoft.Quantum.Chemistry.Jupyter.dll",
        ".\Chemistry\src\Runtime\bin\$Env:BUILD_CONFIGURATION\net6.0\Microsoft.Quantum.Chemistry.Runtime.dll",
        ".\Chemistry\src\Tools\bin\$Env:BUILD_CONFIGURATION\net6.0\qdk-chem.dll"
    ) | ForEach-Object { Join-Path $PSScriptRoot (Join-Path ".." $_) };
} 

if ($OutputFormat -eq 'FileInfo') {
    $artifacts.Packages = $artifacts.Packages | ForEach-Object { Get-Item $_ };
    $artifacts.Assemblies = $artifacts.Assemblies | ForEach-Object { Get-Item $_ };
}
    
$artifacts | Write-Output;
